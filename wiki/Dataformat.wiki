#summary Beskrivelse af dataformatet til plotteren


= Dataformat =

Datafilen indeholder kun *instruktioner på lavt niveau*. For instruktioner på højt niveau: se "Hvordan genereres instruktionsfilen?"

Vi har brug for en række instruktioner, som beskriver, hvad vi skal
gøre med vores hardware. Jeg (Kristian) ser, at vi mindst har brug for
følgende instruktioner:

  * Flyt x-akse-motor frem
  * Flyt x-akse-motor tilbage
  * Flyt y-akse-motor frem
  * Flyt y-akse-motor tilbage
  * Sænk skrivehovedet
  * Løft skrivehovedet

Derudover er det praktisk med følgende instruktioner:

  * Begynd tegning
  * Slut tegning
  * Nul-instruktion (tom instruktion)

vi har plads til de fire ekstra funktioner, så derfor har vi dem med, så de kan køre hurtigere:

  * Skråt op til venstre
  * Skråt op til højre
  * Skråt ned til venstre
  * Skråt ned til højre

Følgende instruktioner kan reducere instruktionsfilens størrelse:

  * Begynd løkke (efter fulgt af X antal bits, som indikerer det antal gange, løkken skal køres)
  * Afslut løkke
  * Gå til-instruktion, hvor stien hen til punktet ikke er vigtig.

Vi har altså 11 forskellige instruktioner, som der skal være plads til
i hver instruktionsenhed. Vi er altså nødt til at bruge 4 bits for at
have plads til alle instruktionerne i en instruktionsenhed. Med 4 bits
har vi plads til 16 (2^4^) instruktioner, og derfor er der plads nok til lige nøjagtig de 16 funktioner.

== Oversigt over instruktioner ==

|| *Værdi* || *Betydning* ||
|| 0x0 (0b0000) || Nul ||
|| 0x1 (0b0001) || Start ||
|| 0x2 (0b0010) || Stop ||
|| 0x3 (0b0011) || Lodret op ↑ ||
|| 0x4 (0b0100) || Op og til højre ↗ ||
|| 0x5 (0b0101) || Til højre → ||
|| 0x6 (0b0110) || Ned til højre ↘ ||
|| 0x7 (0b0111) || Ned ↓ ||
|| 0x8 (0b1000) || Ned til venstre ↙ ||
|| 0x9 (0b1001) || Til venstre ← ||
|| 0xA (0b1010) || Op til venstre ↖ ||
|| 0xB (0b1011) || Skrivehoved ned ||
|| 0xC (0b1100) || Skrivehoved op ||
|| 0xD (0b1101) || Evt. løkke start (antallet er skrevet i de efterfølgende 8 bits) ||
|| 0xE (0b1110) || Evt. løkke stop ||
|| 0xF (0b1111) || Evt. gå til (første 8 bits efter er antal steps vandret, næste 8 bits efter er antal steps lodret ||


Vi kan måske anvende nogle standarder der i forvejen findes.
[http://en.wikipedia.org/wiki/G-code] - noget der bliver anvendt til CNC maskin instruktioner. Dog indeholder de flere instruktioner end vi får brug for på det lave instruktionsniveau.


== Højniveauinstruktioner ==

Hvis vi skal have højniveauinstruktioner, er det nok en god ide kun at have linier. Disse kunne så fortolkes af software på chippen til lavniveauinstruktioner.

Hvis vi også skal have højniveauinstruktioner, har vi brug for flerer bits pr. instruktion end de 4. Fx 8 (for så er en instruktion lig en byte).


= Hvordan genereres instruktionsfilen? =

Vi skal have et program, der kan generere vores instruktionsfil. Ellers skal vi hardcode en instruktionsfil, og det gider jeg (Kristian) ikke.

Det er her, jeg ser den største udfordring: Hvordan omsætter vi en linie, en cirkel, cirkelbue eller funktionsforskrift i et endeligt interval? Kurven skal omsættes matematisk til enten en lodret streg op, lodret streg ned, vandret streg til højre eller vandret streg til venstre.


= Dataoverførsel =

Vi har følgende muligheder for at få data på chippen: Dataene kan

  * hardcores ind i chippen
  * sendes via serielt kabel til chippen
  * lagres på hukommelseskort og læses fra chippen

*Hardcodede data* i chippen er en rigtig dårlig ide. Så skal vi manuelt lave instruktionerne (tegningen) og kompilere dataene ind i et program. Så kan maskinen kun tegne én tegning uden at blive programmeret igen.

*Serielt overførte data* kræver meget computerkommunikation. Måske fylder computerdelen for meget i denne proces. Maskinen er samtidig afhængig af, at computeren er sluttet til under hele tegningen.

*Data lagret på hukommelseskort* kræver hardware til hukommelseskort og software, der kan læse hukommelseskortet. Se [http://www.captain.at/electronic-atmega-sd-card.php hvordan man kan læse SD-kort med en atmega16-chip].